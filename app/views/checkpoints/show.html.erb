<h1> <%="Checkpoint: #{@checkpoint.title}"%> </h1>
<br>
<table class="table table-dark table-striped">
  <thead>
    <tr>
      <th scope="col">Id</th>
      <th scope="col">Recurso</th>
      <th scope="col">Link</th>
      <th scope="col">Current Rating</th>
      <th scope="col">Rate</th>
    </tr>
  </thead>
  <% @checkpoint.resources.each do |resource|%>
  <tbody>
    <tr>
      <th scope="row"> <%= resource.id %> </th>
      <td> <%= resource.title %></td>
      <td> <a class="btn btn-secondary" href=<%= resource.link %> target="_blank">Go!</a> </td>
      <td> <%= ResourceRatingCalculator.calculate_resource_rating(resource) %> </td>
      <td>
      <%= form_with url: rate_resource_roadmap_checkpoint_path(@roadmap, @checkpoint), model: resource, method: "post" do |form| %>
        <%= form.hidden_field :resource_id, value: resource.id %>
        <%= form.number_field :rating, in: 1..5, step: 1, required: true %>
        <%= form.submit "Evaluar" %>
      <% end %>
      </td>
    </tr>    
  </tbody>
  <% end %>
</table>

<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#AddNewResourceModal">
  + Nuevo recurso
</button>

<!-- Modal -->
<div class="modal fade" id="AddNewResourceModal" tabindex="-1" aria-labelledby="resourceModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Añade un nuevo recurso</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <%= form_with url: create_resource_roadmap_checkpoint_path(@roadmap, @checkpoint), model: Resource, method: "post" do |form| %>
          <%= form.label :label_title, "Título" %>
          <%= form.text_field :title %>
          <%= form.label :label_link, "Link" %>
          <%= form.url_field :link %>
          <%= form.submit "Crear" %>
        <% end %>
      </div>
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div>
